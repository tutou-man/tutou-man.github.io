<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta name='renderer' content='webkit'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
    <title>CSS美化压缩格式化</title>
</head>
<style>
    html,body {
        height: 100%;
        width: 100%;
        overflow: hidden;
    }
    fieldset {
        margin: 10px;
    }
    textarea {
        box-sizing: border-box;
        width: 100%;
        border: 1px solid #000;
        display: block;
        padding: 10px;
        background: #fff;
        text-align: justify;
        word-break: break-all;
    }
    button {
        margin-top: 10px;
    }
</style>
<body>
    <fieldset>
        <legend>CSS样式表</legend>
        <textarea id="codeText" name="codeText" rows="20" placeholder="在这里键入你的css代码"></textarea>
        <button type="button" onclick="zip('codeText').value=code.A();">压缩代码</button>
        <button type="button" onclick="zip('codeText').value=code.B();">格式(美化)</button>
        <button type="button" onclick="zip('codeText').value=code.C();">格式(单行)</button>
        <button type="button" onclick="zip('codeText').value=code.Z();">还原代码</button>
    </fieldset>
</body>
<script>
    function zip(id) {
        return document.getElementById(id);
    }
    function codeZip(obj) {
        this.S = function () {
            var code = obj.value;
            if (!this.codeZ || this.codeZ == "")
                this.codeZ = code;
            if (code == "")
                alert('请粘贴CSS样式表');
            code = code.replace(/(\n|\t|\s)*/ig, '$1');
            code = code.replace(/\n|\t|\s(\{|\}|\,|\:|\;)/ig, '$1');
            code = code.replace(/(\{|\}|\,|\:|\;)\s/ig, '$1');
            return code;
        }
        this.A = function () {
            var code = this.S();
            return code;
        }
        this.B = function () {
            var code = this.S();
            code = code.replace(/(\{)/ig, ' $1');
            code = code.replace(/(\{|\;)/ig, '$1\n\t');
            code = code.replace(/\t*(\})/ig, '$1\n');
            code = code.replace(/(\*\/)/ig, '$1\n');
            return code;
        }
        this.C = function () {
            var code = this.S();
            code = code.replace(/(\})/ig, '$1\n');
            code = code.replace(/(\*\/)/ig, '$1\n');
            return code;
        }
        this.Z = function () {
            return (this.codeZ) ? this.codeZ : obj.value;
        }
        var my = this;
        obj.onkeydown = function () {
            my.codeZ = "";
        }
    }
    var code = new codeZip(zip('codeText'));
</script>
</html>
